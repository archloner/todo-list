(()=>{"use strict";class e{createdDate;title;description;dueDate;priority;isComplete;log;notes;checklist;constructor(e,t,s,a){this.id=class{static startingIndex=0;static nextIndex(){return this.startingIndex++}static reset(){this.startingIndex=0}}.nextIndex(),this.title=e,this.description=t,this.dueDate=s,this.priority=a,this.createdDate=new Date,this.isComplete=!1,this.notes=null,this.checklist=[],this.log=[]}isComplete(){return!0===isComplete}markAsComplete(){this.isComplete=!0}markAsNotComplete(){this.isComplete=!1}}class t{static LOW="low";static MEDIUM="medium";static HIGH="high";static DEFAULT="default"}const s={projects:[{id:1,title:"Website development",tasks:[new e("Update about page header","Lorem ipsum dolor sit amet, consectetur adipiscing elit",new Date(2022,1,20),t.DEFAULT),new e("About page wording","Lorem ipsum dolor sit amet, consectetur adipiscing elit",new Date(2022,1,22),t.HIGH),new e("New landing page layout","Lorem ipsum dolor sit amet, consectetur adipiscing elit",new Date(2022,1,17),t.MEDIUM),new e("Update global iconset","Lorem ipsum dolor sit amet, consectetur adipiscing elit",new Date(2022,1,27),t.LOW),new e("New case study thumbnails","Lorem ipsum dolor sit amet, consectetur adipiscing elit",new Date(2022,1,28),t.DEFAULT)]},{id:2,title:"Groceries",tasks:[]}]};class a{currentProject;projects;data;constructor(){this.currentProject=null,this.projects=[],this.data=s,this.projects=this.data.projects}setCurrentProject(e){this.currentProject=e}getData(){return this.data.projects}}class i{constructor(){this.model=new a,this.projects=this.model.getData()}getProjectTasks(e){return this.projects.filter((t=>t.id===e))[0].tasks}}class o{projectController;tasks;projects;constructor(){this.tasks=[],this.projectController=new i}createTask(e,t,s,a){console.log("Creating new task",e,t,s,a)}getProjectTasks(e){return this.projectController.getProjectTasks(e)}setProjectTasks(e){this.tasks=this.getProjectTasks(e)}markTaskAsComplete(e){this.tasks.filter((t=>t.id===e)).markComplete()}}class n{content;taskController;constructor(){this.content=document.querySelector(".wrapper"),this.taskController=new o}init(){this.attachEventListeners(),console.log(this.taskController.getProjectTasks(1))}attachEventListeners(){this.addTaskDetailsToggleEventListeners(),this.addExpandHideAllEventListener(),this.addToggleMoreMenuListener(),this.addDeleteTaskClickListener(),this.addEditTaskClickListener(),this.addShowNewTaskModalEventListener(),this.addHideNewTaskModalEventListener(),this.addNewTaskSubmitListener()}addTaskDetailsToggleEventListeners(){const e=document.querySelectorAll(".task-menu .fa-chevron-down");for(let t of e)t.addEventListener("click",(e=>{const t=e.target.parentNode.parentNode;this.toggleTaskDetails(t)}))}toggleTaskDetails(e){if(e){e.querySelector(".task-details").classList.toggle("hide");const t=e.querySelector(".icon");t.classList.toggle("fa-chevron-up"),t.classList.toggle("fa-chevron-down")}}addExpandHideAllEventListener(){const e="Expand all",t=document.querySelector("#expand-all-hide-all-span");t.addEventListener("click",(s=>{const a=document.querySelectorAll(".task");if(a)if(new String(t.innerText.trim()).includes(e)){for(let e of a)this.showTaskDetails(e);t.textContent="Collapse all"}else{for(let e of a)this.hideTaskDetails(e);t.textContent=e}}))}showTaskDetails(e){e.querySelector(".task-details").classList.remove("hide");const t=e.querySelector(".task-menu .icon");t.classList.remove("fa-chevron-down"),t.classList.add("fa-chevron-up")}hideTaskDetails(e){e.querySelector(".task-details").classList.add("hide");const t=e.querySelector(".task-menu .icon");t.classList.remove("fa-chevron-up"),t.classList.add("fa-chevron-down")}addShowNewTaskModalEventListener(){const e=document.querySelector(".new-task-btn"),t=document.querySelector("#new-task-modal-wrapper");e.addEventListener("click",(e=>{this.showNewTaskModal(t)}))}showNewTaskModal(e){this.resetModalForm(),e.classList.remove("hide")}resetModalForm(){document.querySelector(".new-task-modal .form-row form").reset()}addHideNewTaskModalEventListener(){document.querySelector("#new-task-modal-wrapper").addEventListener("click",(e=>{e.stopPropagation(),e.target.classList.contains("modal-wrapper")&&this.animateModalClosing()})),document.querySelector(".modal-wrapper .close-btn").addEventListener("click",(e=>{this.animateModalClosing()}))}animateModalClosing(){const e=document.querySelector("#new-task-modal-wrapper"),t=e.querySelector(".new-task-modal");t.classList.add("modal-dissmis-animation"),e.classList.remove("wrapper-fade-in-animation"),e.classList.add("wrapper-fade-out-animation"),setTimeout((()=>{e.classList.add("hide"),t.classList.remove("modal-dissmis-animation"),e.classList.remove("wrapper-fade-out-animation"),e.classList.add("wrapper-fade-in-animation")}),600)}addNewTaskSubmitListener(){document.querySelector("#new-task-submit").addEventListener("click",(e=>{this.submitNewTaskModal(),this.animateModalClosing()}))}submitNewTaskModal(){console.log("New task submited!")}addToggleMoreMenuListener(){const e=document.querySelectorAll(".task-menu .more");for(let t of e)t.addEventListener("click",(e=>{const s=t.nextElementSibling;setTimeout((()=>{s.classList.toggle("hide")}),50)}));document.addEventListener("click",(e=>{if(!e.target.classList.contains("more-menu")&&!e.target.classList.contains("more-menu-option")){const e=document.querySelectorAll(".more-menu:not(.hide)");for(let t of e)t.classList.add("hide")}}))}addDeleteTaskClickListener(){const e=document.querySelectorAll(".more-menu-option.delete");console.log(e);for(let t of e){const e=t.parentElement.parentElement.parentElement.parentElement.parentElement.getAttribute("data-index");t.addEventListener("click",this.handleDeleteTask.bind(this,e))}}handleDeleteTask(e){console.log("Deleting task with id "+e)}addEditTaskClickListener(){const e=document.querySelectorAll(".more-menu-option.edit");for(let t of e){const e=t.parentElement.parentElement.parentElement.parentElement.parentElement.getAttribute("data-index");t.addEventListener("click",this.handleEditTask.bind(this,e))}}handleEditTask(e){console.log("Editing task with id "+e)}}class r{constructor(){}}let l=new class{model;controller;view;constructor(){this.model=new a,this.controller=new n,this.view=new r}init(){this.controller.init()}start(){}};l.init(),l.start()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSUgsRUFHbEJ6RCxPQUNFekMsS0FBS29HLFdBQVczRCxPQUdsQjZELFdEaEJGSCxFQUFJMUQsT0FDSjBELEVBQUlHLFMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvZW50aXR5L1Rhc2suanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3V0aWwvSW5kZXhTdXBwbGllci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvZW50aXR5L1ByaW9yaXR5VHlwZS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kZWwvU2FtcGxlRGF0YS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kZWwvTW9kZWwuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2NvbnRyb2xsZXIvUHJvamVjdENvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2NvbnRyb2xsZXIvVGFza0NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2NvbnRyb2xsZXIvRGlzcGxheUNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3ZpZXcvU2luZ2xlUHJvamVjdFZpZXcuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9BcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZXhwb3J0IGNvbnN0IHNhbXBsZVRhc2sgPSB7XG4vLyAgIGNyZWF0ZWREYXRlOiBuZXcgRGF0ZSgpLFxuLy8gICB0aXRsZTogJ1NhbXBsZSB0YXNrJyxcbi8vICAgZGVzY3JpcHRpb246ICdNb3JlIGluZm9ybWF0aW9ucyBhYm91dCBuZXcgdGFzaycsXG4vLyAgIGR1ZURhdGU6IG5ldyBEYXRlKCksXG4vLyAgIHByaW9yaXR5OiBQcmlvcml0eVR5cGUuSElHSCxcbi8vICAgbm90ZXM6ICc/Jyxcbi8vICAgY2hlY2tsaXN0OiAnPycsXG4vLyAgIGxvZzogW11cbi8vIH1cblxuaW1wb3J0IHsgSW5kZXhTdXBwbGllciB9IGZyb20gXCIuLi91dGlsL0luZGV4U3VwcGxpZXJcIjtcblxuZXhwb3J0IGNsYXNzIFRhc2sge1xuICBjcmVhdGVkRGF0ZTtcbiAgdGl0bGU7XG4gIGRlc2NyaXB0aW9uO1xuICBkdWVEYXRlO1xuICBwcmlvcml0eTtcbiAgaXNDb21wbGV0ZTtcbiAgbG9nO1xuICAvLyBvcHRpb25hbD9cbiAgbm90ZXM7XG4gIGNoZWNrbGlzdDtcblxuICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5KSB7XG4gICAgdGhpcy5pZCA9IEluZGV4U3VwcGxpZXIubmV4dEluZGV4KCk7XG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICB0aGlzLmNyZWF0ZWREYXRlID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLmlzQ29tcGxldGUgPSBmYWxzZTtcbiAgICB0aGlzLm5vdGVzID0gbnVsbDtcbiAgICB0aGlzLmNoZWNrbGlzdCA9IFtdO1xuICAgIHRoaXMubG9nID0gW107XG4gIH1cblxuICBpc0NvbXBsZXRlKCkge1xuICAgIHJldHVybiBpc0NvbXBsZXRlID09PSB0cnVlO1xuICB9XG5cbiAgbWFya0FzQ29tcGxldGUoKSB7XG4gICAgdGhpcy5pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgfVxuXG4gIG1hcmtBc05vdENvbXBsZXRlKCkge1xuICAgIHRoaXMuaXNDb21wbGV0ZSA9IGZhbHNlO1xuICB9XG5cbn0iLCJleHBvcnQgY2xhc3MgSW5kZXhTdXBwbGllciB7XG4gIHN0YXRpYyBzdGFydGluZ0luZGV4ID0gMDtcblxuICAvLyBzdGF0aWM/XG4gIC8vIGNvbnN0cnVjdG9yKCkge1xuICAvLyAgIHRoaXMuc3RhcnRpbmdJbmRleCA9IDA7XG4gIC8vIH1cblxuICAvLyBjb25zdHJ1Y3RvcihzdGFydGluZ0luZGV4KSB7XG4gIC8vICAgdGhpcy5zdGFydGluZ0luZGV4ID0gc3RhcnRpbmdJbmRleDtcbiAgLy8gfVxuXG4gIHN0YXRpYyBuZXh0SW5kZXgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhcnRpbmdJbmRleCsrO1xuICB9XG5cbiAgc3RhdGljIHJlc2V0KCkge1xuICAgIHRoaXMuc3RhcnRpbmdJbmRleCA9IDA7XG4gIH1cblxufSIsImV4cG9ydCBjbGFzcyBQcmlvcml0eVR5cGUge1xuICBzdGF0aWMgTE9XID0gJ2xvdyc7XG4gIHN0YXRpYyBNRURJVU0gPSAnbWVkaXVtJztcbiAgc3RhdGljIEhJR0ggPSAnaGlnaCc7XG4gIHN0YXRpYyBERUZBVUxUID0gJ2RlZmF1bHQnO1xufSIsImltcG9ydCB7IFRhc2sgfSBmcm9tIFwiLi4vZW50aXR5L1Rhc2tcIjtcbmltcG9ydCB7IFByaW9yaXR5VHlwZSB9IGZyb20gXCIuLi9lbnRpdHkvUHJpb3JpdHlUeXBlXCI7XG5cbi8vIGNvbnN0cnVjdG9yKHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHkpXG5leHBvcnQgY29uc3Qgc2FtcGxlRGF0YSA9IHtcbiAgcHJvamVjdHM6IFtcbiAgICB7XG4gICAgICBpZDogMSxcbiAgICAgIHRpdGxlOiBcIldlYnNpdGUgZGV2ZWxvcG1lbnRcIixcbiAgICAgIHRhc2tzOiBbXG4gICAgICAgIG5ldyBUYXNrKFxuICAgICAgICAgIFwiVXBkYXRlIGFib3V0IHBhZ2UgaGVhZGVyXCIsXG4gICAgICAgICAgXCJMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0XCIsXG4gICAgICAgICAgbmV3IERhdGUoMjAyMiwgMSwgMjApLFxuICAgICAgICAgIFByaW9yaXR5VHlwZS5ERUZBVUxUXG4gICAgICAgICksXG4gICAgICAgIG5ldyBUYXNrKFxuICAgICAgICAgIFwiQWJvdXQgcGFnZSB3b3JkaW5nXCIsXG4gICAgICAgICAgXCJMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0XCIsXG4gICAgICAgICAgbmV3IERhdGUoMjAyMiwgMSwgMjIpLFxuICAgICAgICAgIFByaW9yaXR5VHlwZS5ISUdIXG4gICAgICAgICksXG4gICAgICAgIG5ldyBUYXNrKFxuICAgICAgICAgIFwiTmV3IGxhbmRpbmcgcGFnZSBsYXlvdXRcIixcbiAgICAgICAgICBcIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXRcIixcbiAgICAgICAgICBuZXcgRGF0ZSgyMDIyLCAxLCAxNyksXG4gICAgICAgICAgUHJpb3JpdHlUeXBlLk1FRElVTVxuICAgICAgICApLFxuICAgICAgICBuZXcgVGFzayhcbiAgICAgICAgICBcIlVwZGF0ZSBnbG9iYWwgaWNvbnNldFwiLFxuICAgICAgICAgIFwiTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdFwiLFxuICAgICAgICAgIG5ldyBEYXRlKDIwMjIsIDEsIDI3KSxcbiAgICAgICAgICBQcmlvcml0eVR5cGUuTE9XXG4gICAgICAgICksXG4gICAgICAgIG5ldyBUYXNrKFxuICAgICAgICAgIFwiTmV3IGNhc2Ugc3R1ZHkgdGh1bWJuYWlsc1wiLFxuICAgICAgICAgIFwiTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdFwiLFxuICAgICAgICAgIG5ldyBEYXRlKDIwMjIsIDEsIDI4KSxcbiAgICAgICAgICBQcmlvcml0eVR5cGUuREVGQVVMVFxuICAgICAgICApLFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAyLFxuICAgICAgdGl0bGU6ICdHcm9jZXJpZXMnLFxuICAgICAgdGFza3M6IFtdLFxuICAgIH1cbiAgXSxcbn07XG4iLCJpbXBvcnQgeyBzYW1wbGVEYXRhIH0gZnJvbSBcIi4vU2FtcGxlRGF0YVwiO1xuXG5leHBvcnQgY2xhc3MgTW9kZWwge1xuICBjdXJyZW50UHJvamVjdDtcbiAgcHJvamVjdHM7XG4gIGRhdGE7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jdXJyZW50UHJvamVjdCA9IG51bGw7XG4gICAgdGhpcy5wcm9qZWN0cyA9IFtdO1xuICAgIHRoaXMuZGF0YSA9IHNhbXBsZURhdGE7XG4gICAgdGhpcy5wcm9qZWN0cyA9IHRoaXMuZGF0YS5wcm9qZWN0cztcbiAgfVxuXG4gIHNldEN1cnJlbnRQcm9qZWN0KHByb2plY3QpIHtcbiAgICB0aGlzLmN1cnJlbnRQcm9qZWN0ID0gcHJvamVjdDtcbiAgfVxuXG4gIGdldERhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5wcm9qZWN0cztcbiAgfVxufSIsImltcG9ydCB7IE1vZGVsIH0gZnJvbSBcIi4uL21vZGVsL01vZGVsXCI7XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0Q29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubW9kZWwgPSBuZXcgTW9kZWwoKTtcbiAgICB0aGlzLnByb2plY3RzID0gdGhpcy5tb2RlbC5nZXREYXRhKCk7XG4gIH1cblxuICBnZXRQcm9qZWN0VGFza3MocHJvamVjdElkKSB7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9qZWN0cyk7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9qZWN0cy5maWx0ZXIoKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHByb2plY3RJZClbMF0udGFza3MpO1xuICAgIHJldHVybiB0aGlzLnByb2plY3RzLmZpbHRlcigocHJvamVjdCkgPT4gcHJvamVjdC5pZCA9PT0gcHJvamVjdElkKVswXS50YXNrcztcbiAgfVxufVxuIiwiaW1wb3J0IHsgUHJvamVjdENvbnRyb2xsZXIgfSBmcm9tICcuL1Byb2plY3RDb250cm9sbGVyJztcblxuZXhwb3J0IGNsYXNzIFRhc2tDb250cm9sbGVyIHtcbiAgcHJvamVjdENvbnRyb2xsZXI7XG4gIHRhc2tzO1xuICBwcm9qZWN0cztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRhc2tzID0gW107XG4gICAgdGhpcy5wcm9qZWN0Q29udHJvbGxlciA9IG5ldyBQcm9qZWN0Q29udHJvbGxlcigpO1xuICB9XG5cbiAgY3JlYXRlVGFzayh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKSB7XG4gICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIG5ldyB0YXNrJywgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSk7XG4gIH1cblxuICBnZXRQcm9qZWN0VGFza3MocHJvamVjdElkKSB7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9qZWN0Q29udHJvbGxlci5nZXRQcm9qZWN0VGFza3MoMSkpXG4gICAgcmV0dXJuIHRoaXMucHJvamVjdENvbnRyb2xsZXIuZ2V0UHJvamVjdFRhc2tzKHByb2plY3RJZCk7XG4gICAgcmV0dXJuIHRoaXMucHJvamVjdHMuZmlsdGVyKChwcm9qZWN0KSA9PiBwcm9qZWN0LmlkID09PSBwcm9qZWN0SWQpLnRhc2tzO1xuICB9XG5cbiAgc2V0UHJvamVjdFRhc2tzKHByb2plY3RJZCkge1xuICAgIHRoaXMudGFza3MgPSB0aGlzLmdldFByb2plY3RUYXNrcyhwcm9qZWN0SWQpO1xuICB9XG5cbiAgbWFya1Rhc2tBc0NvbXBsZXRlKHRhc2tJZCkge1xuICAgIGxldCB0YXNrID0gdGhpcy50YXNrcy5maWx0ZXIoKHRhc2spID0+IHRhc2suaWQgPT09IHRhc2tJZCk7XG4gICAgdGFzay5tYXJrQ29tcGxldGUoKTtcbiAgICAvLyBtb3ZlIHRvIGNvbXBsZXRlL2RvbmUgc2VjdGlvbj9cbiAgfVxufSIsImltcG9ydCB7IFRhc2tDb250cm9sbGVyIH0gZnJvbSBcIi4vVGFza0NvbnRyb2xsZXJcIjtcblxuZXhwb3J0IGNsYXNzIERpc3BsYXlDb250cm9sbGVyIHtcbiAgY29udGVudDtcbiAgdGFza0NvbnRyb2xsZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53cmFwcGVyXCIpO1xuICAgIHRoaXMudGFza0NvbnRyb2xsZXIgPSBuZXcgVGFza0NvbnRyb2xsZXIoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5hdHRhY2hFdmVudExpc3RlbmVycygpO1xuICAgIGNvbnNvbGUubG9nKHRoaXMudGFza0NvbnRyb2xsZXIuZ2V0UHJvamVjdFRhc2tzKDEpKTtcbiAgICAvLyB2aWV3LnJlbmRlcihwcm9qZWN0KVxuICB9XG5cbiAgYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gU2hvd2luZyBhbmQgaGlkaW5nIHRhc2sgZGV0YWlsc1xuICAgIHRoaXMuYWRkVGFza0RldGFpbHNUb2dnbGVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuYWRkRXhwYW5kSGlkZUFsbEV2ZW50TGlzdGVuZXIoKTtcbiAgICAvLyBUYXNrIG1vcmUgbWVudSBvcGVuL2Nsb3NlXG4gICAgdGhpcy5hZGRUb2dnbGVNb3JlTWVudUxpc3RlbmVyKCk7XG4gICAgdGhpcy5hZGREZWxldGVUYXNrQ2xpY2tMaXN0ZW5lcigpO1xuICAgIHRoaXMuYWRkRWRpdFRhc2tDbGlja0xpc3RlbmVyKCk7XG4gICAgLy8gTmV3IFRhc2sgbW9kYWwgc2hvdyBidXR0b24gYW5kIGNsb3NlXG4gICAgdGhpcy5hZGRTaG93TmV3VGFza01vZGFsRXZlbnRMaXN0ZW5lcigpO1xuICAgIHRoaXMuYWRkSGlkZU5ld1Rhc2tNb2RhbEV2ZW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLmFkZE5ld1Rhc2tTdWJtaXRMaXN0ZW5lcigpO1xuICAgIC8vIHRoaXMuYWRkRGVsZXRlVGFza0xpc3RlbmVyKCk7XG4gIH1cblxuICBhZGRUYXNrRGV0YWlsc1RvZ2dsZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRhc2stbWVudSAuZmEtY2hldnJvbi1kb3duXCIpO1xuICAgIGZvciAobGV0IGJ1dHRvbiBvZiBidXR0b25zKSB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGljb24gPSBlLnRhcmdldDtcbiAgICAgICAgY29uc3QgdGFzayA9IGljb24ucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB0aGlzLnRvZ2dsZVRhc2tEZXRhaWxzKHRhc2spO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlVGFza0RldGFpbHModGFza0VsZW1lbnQpIHtcbiAgICBpZiAodGFza0VsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGRldGFpbHMgPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stZGV0YWlsc1wiKTtcbiAgICAgIGRldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZShcImhpZGVcIik7XG5cbiAgICAgIGNvbnN0IGljb24gPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmljb25cIik7XG4gICAgICBpY29uLmNsYXNzTGlzdC50b2dnbGUoXCJmYS1jaGV2cm9uLXVwXCIpO1xuICAgICAgaWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwiZmEtY2hldnJvbi1kb3duXCIpO1xuICAgIH1cbiAgfVxuXG4gIGFkZEV4cGFuZEhpZGVBbGxFdmVudExpc3RlbmVyKCkge1xuICAgIGNvbnN0IFRFWFRfQ09OVEVOVF9UT19FWFBBTkQgPSBcIkV4cGFuZCBhbGxcIjtcbiAgICAvLyBJbml0aWFsIHN0YXRlIGlzIHRvIGV4cGFuZFxuICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZXhwYW5kLWFsbC1oaWRlLWFsbC1zcGFuXCIpO1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGNvbnN0IHRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YXNrXCIpO1xuICAgICAgaWYgKHRhc2tzKSB7XG4gICAgICAgIGlmIChuZXcgU3RyaW5nKGJ0bi5pbm5lclRleHQudHJpbSgpKS5pbmNsdWRlcyhURVhUX0NPTlRFTlRfVE9fRVhQQU5EKSkge1xuICAgICAgICAgIGZvciAobGV0IHRhc2sgb2YgdGFza3MpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1Rhc2tEZXRhaWxzKHRhc2spO1xuICAgICAgICAgIH1cbiAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSBcIkNvbGxhcHNlIGFsbFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAobGV0IHRhc2sgb2YgdGFza3MpIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVRhc2tEZXRhaWxzKHRhc2spO1xuICAgICAgICAgIH1cbiAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSBURVhUX0NPTlRFTlRfVE9fRVhQQU5EO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBzaG93VGFza0RldGFpbHModGFzaykge1xuICAgIGNvbnN0IHRhc2tEZXRhaWxzVG9TaG93ID0gdGFzay5xdWVyeVNlbGVjdG9yKFwiLnRhc2stZGV0YWlsc1wiKTtcbiAgICB0YXNrRGV0YWlsc1RvU2hvdy5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICBjb25zdCBjaGV2cm9uID0gdGFzay5xdWVyeVNlbGVjdG9yKFwiLnRhc2stbWVudSAuaWNvblwiKTtcbiAgICBjaGV2cm9uLmNsYXNzTGlzdC5yZW1vdmUoXCJmYS1jaGV2cm9uLWRvd25cIik7XG4gICAgY2hldnJvbi5jbGFzc0xpc3QuYWRkKFwiZmEtY2hldnJvbi11cFwiKTtcbiAgfVxuXG4gIGhpZGVUYXNrRGV0YWlscyh0YXNrKSB7XG4gICAgY29uc3QgdGFza0RldGFpbHNUb1Nob3cgPSB0YXNrLnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1kZXRhaWxzXCIpO1xuICAgIHRhc2tEZXRhaWxzVG9TaG93LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgIGNvbnN0IGNoZXZyb24gPSB0YXNrLnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1tZW51IC5pY29uXCIpO1xuICAgIGNoZXZyb24uY2xhc3NMaXN0LnJlbW92ZShcImZhLWNoZXZyb24tdXBcIik7XG4gICAgY2hldnJvbi5jbGFzc0xpc3QuYWRkKFwiZmEtY2hldnJvbi1kb3duXCIpO1xuICB9XG5cbiAgYWRkU2hvd05ld1Rhc2tNb2RhbEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctdGFzay1idG5cIik7XG4gICAgY29uc3QgbW9kYWxXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctdGFzay1tb2RhbC13cmFwcGVyXCIpO1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuc2hvd05ld1Rhc2tNb2RhbChtb2RhbFdyYXBwZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgc2hvd05ld1Rhc2tNb2RhbChtb2RhbFdyYXBwZXIpIHtcbiAgICB0aGlzLnJlc2V0TW9kYWxGb3JtKCk7XG4gICAgbW9kYWxXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICB9XG5cbiAgcmVzZXRNb2RhbEZvcm0oKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXRhc2stbW9kYWwgLmZvcm0tcm93IGZvcm1cIik7XG4gICAgZm9ybS5yZXNldCgpO1xuICB9XG5cbiAgYWRkSGlkZU5ld1Rhc2tNb2RhbEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXRhc2stbW9kYWwtd3JhcHBlclwiKTtcbiAgICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbC13cmFwcGVyXCIpKSB7XG4gICAgICAgIHRoaXMuYW5pbWF0ZU1vZGFsQ2xvc2luZygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLXdyYXBwZXIgLmNsb3NlLWJ0blwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuYW5pbWF0ZU1vZGFsQ2xvc2luZygpO1xuICAgIH0pO1xuICB9XG5cbiAgYW5pbWF0ZU1vZGFsQ2xvc2luZygpIHtcbiAgICBjb25zdCBBTklNQVRJT05fRFVSQVRJT05fVElNRSA9IDYwMDtcblxuICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy10YXNrLW1vZGFsLXdyYXBwZXJcIik7XG4gICAgY29uc3QgbW9kYWwgPSB3cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXRhc2stbW9kYWxcIik7XG5cbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWwtZGlzc21pcy1hbmltYXRpb25cIik7XG4gICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKFwid3JhcHBlci1mYWRlLWluLWFuaW1hdGlvblwiKTtcbiAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoXCJ3cmFwcGVyLWZhZGUtb3V0LWFuaW1hdGlvblwiKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWwtZGlzc21pcy1hbmltYXRpb25cIik7XG4gICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJ3cmFwcGVyLWZhZGUtb3V0LWFuaW1hdGlvblwiKTtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZChcIndyYXBwZXItZmFkZS1pbi1hbmltYXRpb25cIik7XG4gICAgfSwgQU5JTUFUSU9OX0RVUkFUSU9OX1RJTUUpO1xuICB9XG5cbiAgYWRkTmV3VGFza1N1Ym1pdExpc3RlbmVyKCkge1xuICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXRhc2stc3VibWl0XCIpO1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0TmV3VGFza01vZGFsKCk7XG4gICAgICB0aGlzLmFuaW1hdGVNb2RhbENsb3NpbmcoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHN1Ym1pdE5ld1Rhc2tNb2RhbCgpIHtcbiAgICBjb25zb2xlLmxvZyhcIk5ldyB0YXNrIHN1Ym1pdGVkIVwiKTtcbiAgfVxuXG4gIC8vIGFkZERlbGV0ZVRhc2tMaXN0ZW5lcigpIHtcbiAgLy8gICBjb25zdCBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YXNrLW1lbnUgLmRlbGV0ZVwiKTtcbiAgLy8gICBmb3IgKGxldCBidG4gb2YgYnRucykge1xuICAvLyAgICAgY29uc3QgdGFzayA9IGJ0bi5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgLy8gICAgIGNvbnN0IHRhc2tJZCA9IHRhc2suZ2V0QXR0cmlidXRlKFwiZGF0YS1pbmRleFwiKTtcbiAgLy8gICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5oYW5kbGVEZWxldGVUYXNrLmJpbmQodGhpcywgdGFza0lkKSk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gaGFuZGxlRGVsZXRlVGFzayh0YXNrSWQpIHtcbiAgLy8gICBjb25zb2xlLmxvZyhcImRlbGV0ZSB0YXNrIHdpdGggaWQgXCIgKyB0YXNrSWQpO1xuICAvLyAgIC8vIHRoaXMuY29uZmlybVRhc2tEZWxldGUoKTtcbiAgLy8gfVxuXG4gIGFkZFRvZ2dsZU1vcmVNZW51TGlzdGVuZXIoKSB7XG4gICAgY29uc3QgYnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGFzay1tZW51IC5tb3JlXCIpO1xuICAgIGZvciAobGV0IGJ0biBvZiBidG5zKSB7XG4gICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IG1lbnUgPSBidG4ubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBtZW51LmNsYXNzTGlzdC50b2dnbGUoXCJoaWRlXCIpO1xuICAgICAgICB9LCA1MCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIC8vIGlmIGNsaWNrZWQgb3V0c2lkZSBvZiAubW9yZS1tZW51IGFuZCBub3Qgb24gbW9yZSBidXR0b25cbiAgICAgIGlmIChcbiAgICAgICAgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vcmUtbWVudVwiKSAmJlxuICAgICAgICAhZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9yZS1tZW51LW9wdGlvblwiKVxuICAgICAgKSB7XG4gICAgICAgIC8vIGhpZGUgYWxsIG1lbnVzXG4gICAgICAgIGNvbnN0IG1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb3JlLW1lbnU6bm90KC5oaWRlKVwiKTtcbiAgICAgICAgZm9yIChsZXQgbWVudSBvZiBtZW51cykge1xuICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7IC8vIGhpZGVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgYWRkRGVsZXRlVGFza0NsaWNrTGlzdGVuZXIoKSB7XG4gICAgY29uc3QgZGVsZXRlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9yZS1tZW51LW9wdGlvbi5kZWxldGVcIik7XG4gICAgY29uc29sZS5sb2coZGVsZXRlQnRucyk7XG4gICAgZm9yIChsZXQgYnRuIG9mIGRlbGV0ZUJ0bnMpIHtcbiAgICAgIGNvbnN0IGluZGV4ID1cbiAgICAgICAgYnRuLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgXCJkYXRhLWluZGV4XCJcbiAgICAgICAgKTtcbiAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5oYW5kbGVEZWxldGVUYXNrLmJpbmQodGhpcywgaW5kZXgpKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVEZWxldGVUYXNrKGluZGV4KSB7XG4gICAgY29uc29sZS5sb2coXCJEZWxldGluZyB0YXNrIHdpdGggaWQgXCIgKyBpbmRleCk7XG4gICAgLy8gdGhpcy5jb25maXJtRGVsZXRpbmdUYXNrKCk7XG4gICAgLy8gbW9kZWwuZGVsZXRlVGFzayh0YXNrSWQpO1xuICB9XG5cbiAgYWRkRWRpdFRhc2tDbGlja0xpc3RlbmVyKCkge1xuICAgIGNvbnN0IGVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb3JlLW1lbnUtb3B0aW9uLmVkaXRcIik7XG4gICAgZm9yIChsZXQgYnRuIG9mIGVkaXRCdG5zKSB7XG4gICAgICBjb25zdCBpbmRleCA9XG4gICAgICAgIGJ0bi5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFxuICAgICAgICAgIFwiZGF0YS1pbmRleFwiXG4gICAgICAgICk7XG4gICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlRWRpdFRhc2suYmluZCh0aGlzLCBpbmRleCkpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUVkaXRUYXNrKGluZGV4KSB7XG4gICAgY29uc29sZS5sb2coXCJFZGl0aW5nIHRhc2sgd2l0aCBpZCBcIiArIGluZGV4KTtcbiAgICAvLyBvcGVuIGVkaXQgbW9kYWxcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFNpbmdsZVByb2plY3RWaWV3IHtcblxuICBjb25zdHJ1Y3RvcigpIHt9XG59IiwiaW1wb3J0IHsgQXBwIH0gZnJvbSAnLi9BcHAnO1xuXG5sZXQgYXBwID0gbmV3IEFwcCgpO1xuYXBwLmluaXQoKTtcbmFwcC5zdGFydCgpOyIsImltcG9ydCB7IE1vZGVsIH0gZnJvbSAnLi9tb2RlbC9Nb2RlbCc7XG5pbXBvcnQgeyBEaXNwbGF5Q29udHJvbGxlciB9IGZyb20gJy4vY29udHJvbGxlci9EaXNwbGF5Q29udHJvbGxlcic7XG5pbXBvcnQgeyBTaW5nbGVQcm9qZWN0VmlldyB9IGZyb20gJy4vdmlldy9TaW5nbGVQcm9qZWN0Vmlldyc7XG5cbmV4cG9ydCBjbGFzcyBBcHAge1xuICBtb2RlbDtcbiAgY29udHJvbGxlcjtcbiAgdmlldztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1vZGVsID0gbmV3IE1vZGVsKCk7XG4gICAgdGhpcy5jb250cm9sbGVyID0gbmV3IERpc3BsYXlDb250cm9sbGVyKCk7XG4gICAgdGhpcy52aWV3ID0gbmV3IFNpbmdsZVByb2plY3RWaWV3KCk7XG4gIH1cblxuICBpbml0KCkge1xuICAgIHRoaXMuY29udHJvbGxlci5pbml0KCk7XG4gIH1cblxuICBzdGFydCgpIHt9XG59Il0sIm5hbWVzIjpbIlRhc2siLCJjcmVhdGVkRGF0ZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJpc0NvbXBsZXRlIiwibG9nIiwibm90ZXMiLCJjaGVja2xpc3QiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJpZCIsInN0YXRpYyIsInN0YXJ0aW5nSW5kZXgiLCJuZXh0SW5kZXgiLCJEYXRlIiwibWFya0FzQ29tcGxldGUiLCJtYXJrQXNOb3RDb21wbGV0ZSIsIlByaW9yaXR5VHlwZSIsInNhbXBsZURhdGEiLCJwcm9qZWN0cyIsInRhc2tzIiwiREVGQVVMVCIsIkhJR0giLCJNRURJVU0iLCJMT1ciLCJNb2RlbCIsImN1cnJlbnRQcm9qZWN0IiwiZGF0YSIsInNldEN1cnJlbnRQcm9qZWN0IiwicHJvamVjdCIsImdldERhdGEiLCJQcm9qZWN0Q29udHJvbGxlciIsIm1vZGVsIiwiZ2V0UHJvamVjdFRhc2tzIiwicHJvamVjdElkIiwiZmlsdGVyIiwiVGFza0NvbnRyb2xsZXIiLCJwcm9qZWN0Q29udHJvbGxlciIsImNyZWF0ZVRhc2siLCJjb25zb2xlIiwic2V0UHJvamVjdFRhc2tzIiwibWFya1Rhc2tBc0NvbXBsZXRlIiwidGFza0lkIiwidGFzayIsIm1hcmtDb21wbGV0ZSIsIkRpc3BsYXlDb250cm9sbGVyIiwiY29udGVudCIsInRhc2tDb250cm9sbGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5pdCIsImF0dGFjaEV2ZW50TGlzdGVuZXJzIiwiYWRkVGFza0RldGFpbHNUb2dnbGVFdmVudExpc3RlbmVycyIsImFkZEV4cGFuZEhpZGVBbGxFdmVudExpc3RlbmVyIiwiYWRkVG9nZ2xlTW9yZU1lbnVMaXN0ZW5lciIsImFkZERlbGV0ZVRhc2tDbGlja0xpc3RlbmVyIiwiYWRkRWRpdFRhc2tDbGlja0xpc3RlbmVyIiwiYWRkU2hvd05ld1Rhc2tNb2RhbEV2ZW50TGlzdGVuZXIiLCJhZGRIaWRlTmV3VGFza01vZGFsRXZlbnRMaXN0ZW5lciIsImFkZE5ld1Rhc2tTdWJtaXRMaXN0ZW5lciIsImJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJwYXJlbnROb2RlIiwidG9nZ2xlVGFza0RldGFpbHMiLCJ0YXNrRWxlbWVudCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImljb24iLCJURVhUX0NPTlRFTlRfVE9fRVhQQU5EIiwiYnRuIiwiU3RyaW5nIiwiaW5uZXJUZXh0IiwidHJpbSIsImluY2x1ZGVzIiwic2hvd1Rhc2tEZXRhaWxzIiwidGV4dENvbnRlbnQiLCJoaWRlVGFza0RldGFpbHMiLCJyZW1vdmUiLCJjaGV2cm9uIiwiYWRkIiwibW9kYWxXcmFwcGVyIiwic2hvd05ld1Rhc2tNb2RhbCIsInJlc2V0TW9kYWxGb3JtIiwicmVzZXQiLCJzdG9wUHJvcGFnYXRpb24iLCJjb250YWlucyIsImFuaW1hdGVNb2RhbENsb3NpbmciLCJ3cmFwcGVyIiwibW9kYWwiLCJzZXRUaW1lb3V0Iiwic3VibWl0TmV3VGFza01vZGFsIiwiYnRucyIsIm1lbnUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJtZW51cyIsImRlbGV0ZUJ0bnMiLCJpbmRleCIsInBhcmVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJoYW5kbGVEZWxldGVUYXNrIiwiYmluZCIsImVkaXRCdG5zIiwiaGFuZGxlRWRpdFRhc2siLCJTaW5nbGVQcm9qZWN0VmlldyIsImFwcCIsImNvbnRyb2xsZXIiLCJ2aWV3Iiwic3RhcnQiXSwic291cmNlUm9vdCI6IiJ9